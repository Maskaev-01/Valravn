# üîÑ –ú–ò–ì–†–ê–¶–ò–Ø –¢–ò–ü–û–í –ü–†–ï–î–ú–ï–¢–û–í –ò–ù–í–ï–ù–¢–ê–†–Ø

**–î–∞—Ç–∞:** $(date)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ü–†–ò–ú–ï–ù–ï–ù–ò–Æ

## üéØ –¶–µ–ª—å –º–∏–≥—Ä–∞—Ü–∏–∏

–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ `item_type` –Ω–∞ –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ —Ç–∞–±–ª–∏—Ü–µ `inventory_item_types` –¥–ª—è:
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- –£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∏–ø–∞–º–∏

## üìä –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –¢–µ–∫—É—â–∏–µ —Ç–∏–ø—ã –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ:
- `–æ—Ä—É–∂–∏–µ` ‚Üí –û—Ä—É–∂–∏–µ (id=1)
- `—É–∫—Ä–∞—à–µ–Ω–∏—è` ‚Üí –£–∫—Ä–∞—à–µ–Ω–∏—è (id=3)  
- `–æ–¥–µ–∂–¥–∞` ‚Üí –û–¥–µ–∂–¥–∞ (id=5)
- `–∞–∫—Å–µ—Å—Å—É–∞—Ä—ã` ‚Üí –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã (id=6)
- `–æ–±—É–≤—å` ‚Üí –û–¥–µ–∂–¥–∞ (id=5)
- `–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã` ‚Üí –ë—ã—Ç–æ–≤—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã (id=4)
- `–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã` ‚Üí –ë—ã—Ç–æ–≤—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã (id=4)

### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∏–ø–æ–≤:
```sql
1 | –û—Ä—É–∂–∏–µ          | –ú–µ—á–∏, —Ç–æ–ø–æ—Ä—ã, –∫–æ–ø—å—è –∏ –¥—Ä—É–≥–æ–µ –æ—Ä—É–∂–∏–µ
2 | –î–æ—Å–ø–µ—Ö–∏         | –ö–æ–ª—å—á—É–≥–∏, —à–ª–µ–º—ã, —â–∏—Ç—ã  
3 | –£–∫—Ä–∞—à–µ–Ω–∏—è       | –ë—Ä–∞—Å–ª–µ—Ç—ã, –∫–æ–ª—å—Ü–∞, –ø–æ–¥–≤–µ—Å–∫–∏
4 | –ë—ã—Ç–æ–≤—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã| –ü–æ—Å—É–¥–∞, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —É—Ç–≤–∞—Ä—å
5 | –û–¥–µ–∂–¥–∞          | –≠–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Å—Ç—é–º–∞
6 | –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã      | –†–µ–º–Ω–∏, —Å—É–º–∫–∏, –ø—Ä–æ—á–∏–µ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã
7 | –ü—Ä–æ—á–µ–µ          | –î—Ä—É–≥–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã
```

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. –ú–æ–¥–µ–ª—å Inventory (models.py)
```python
class Inventory(Base):
    # –°—Ç–∞—Ä–æ–µ –ø–æ–ª–µ - –æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    item_type = Column(Text)  
    
    # –ù–æ–≤–æ–µ –ø–æ–ª–µ - –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á
    item_type_id = Column(Integer, ForeignKey("inventory_item_types.id", ondelete="SET NULL"), nullable=True)
    
    # –°–≤—è–∑—å —Å —Ç–∞–±–ª–∏—Ü–µ–π —Ç–∏–ø–æ–≤
    item_type_ref = relationship("InventoryItemType", foreign_keys=[item_type_id])
```

### 2. –†–æ—É—Ç–µ—Ä inventory.py
```python
# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–æ–≤–æ–º—É –ø–æ–ª—é
if item_type and item_type != "all":
    try:
        item_type_id = int(item_type)
        query = query.filter(Inventory.item_type_id == item_type_id)
    except ValueError:
        # –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º –ø–æ–ª–µ–º
        query = query.filter(Inventory.item_type == item_type)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–∏–ø–æ–≤ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
types_list_query = text('''
    SELECT DISTINCT iit.id, iit.name, iit.sort_order
    FROM inventory_item_types iit
    INNER JOIN inventory i ON i.item_type_id = iit.id
    WHERE iit.is_active = true
    ORDER BY iit.sort_order, iit.name
''')
```

### 3. –®–∞–±–ª–æ–Ω list.html
```html
<!-- –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø–∞–º —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ID -->
<option value="{{ type_item[0] }}">{{ type_item[1] }}</option>
```

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏—é
```bash
psql -d valravn -f migration_inventory_item_type_fk.sql
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –ø–æ —Ç–∏–ø–∞–º
SELECT 
    iit.name as type_name,
    COUNT(i.id) as items_count
FROM inventory i
LEFT JOIN inventory_item_types iit ON i.item_type_id = iit.id
GROUP BY iit.id, iit.name
ORDER BY iit.sort_order;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø–∏—Å–∏ –±–µ–∑ —Ç–∏–ø–∞
SELECT COUNT(*) FROM inventory WHERE item_type_id IS NULL AND item_type IS NOT NULL;
```

### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ú–æ–¥–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ –†–æ—É—Ç–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω  
- ‚úÖ –®–∞–±–ª–æ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω

### –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Ç–∏–ø–∞–º –≤ `/inventory`
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö

## üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –°—Ç–∞—Ä–æ–µ –ø–æ–ª–µ `item_type` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ–±–æ–∏–º–∏ –ø–æ–ª—è–º–∏
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤–æ–µ –ø–æ–ª–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
1. **–§–∏–ª—å—Ç—Ä —Ç–∏–ø–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–∏–ø—ã –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞** - JOIN –ø–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –ø–æ–ª—é –±—ã—Å—Ç—Ä–µ–µ
3. **–î–∞–Ω–Ω—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã** - –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–∏–ø–æ–≤
4. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - —Ç–∏–ø—ã —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–ï —É–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä–æ–µ –ø–æ–ª–µ** `item_type` –¥–æ –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ñ–æ—Ä–º—ã** –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
3. **–û–±–Ω–æ–≤–∏—Ç—å API** –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø
4. **–°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é** –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏

## üéâ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏

–§–∏–ª—å—Ç—Ä —Ç–∏–ø–æ–≤ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –±—É–¥–µ—Ç:
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–∏–ø—ã –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤
- ‚úÖ –†–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 